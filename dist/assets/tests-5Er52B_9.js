import{j as e,r as n,B as H,L as D}from"./index-QSll8v0V.js";import{f as y,P as x,T as b,a as f,b as p,c as j,d as s,e as N,g}from"./api-4lqmvLb2.js";const l="_tableHeaderCell_3rkz9_1",z="_filterBox_3rkz9_5";const E=({callStack:i})=>{const r=i[i.length-1];return r.prId?e.jsxs("a",{target:"_blank",rel:"noreferrer",href:`https://github.com/nodejs/node/pull/${r.prId}`,children:["PR ",r.prId]}):e.jsxs("a",{href:`https://ci.nodejs.org/${r.upstreamUrl}${r.upstreamBuild}`,target:"_blank",rel:"noreferrer",children:[r.upstreamProject,", ",r.upstreamBuild]})},A=()=>{const[i,r]=n.useState([]),[T,k]=n.useState([]),[B,m]=n.useState([]),[h,C]=n.useState(""),[o,S]=n.useState("");n.useEffect(()=>{y().then(({data:t})=>{r(t)})},[]),n.useEffect(()=>{const t=Date.now()-12096e5,c=i.reduce((a,d)=>d.timestamp<t?a:{...a,[d.testName]:a[d.testName]?a[d.testName]+1:1},{}),u=Object.entries(c);u.sort((a,d)=>a[1]>d[1]?-1:1),k(u.slice(0,10)),m(i.map(a=>h.length&&!a.testName.includes(h)||o.length&&a.date!==o?null:a).filter(a=>a!==null).slice(0,100))},[i,o,m,h]);const _=t=>{C(t.target.value.trim())},v=t=>{S(t.target.value.trim())};return e.jsxs(e.Fragment,{children:[e.jsx(H,{component:D,to:"/",children:"Back"}),e.jsx("h4",{children:"Most failed tests"}),e.jsx(x,{sx:{width:"100%",overflow:"hidden"},children:e.jsx(b,{component:x,children:e.jsxs(f,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[e.jsx(p,{children:e.jsxs(j,{children:[e.jsx(s,{className:l,children:"Test name"}),e.jsx(s,{className:l,children:"Number of failures in the past two weeks"})]})}),e.jsx(N,{children:T.map((t,c)=>e.jsxs(j,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(s,{component:"th",scope:"row",children:t[0]}),e.jsx(s,{children:t[1]})]},c))})]})})}),e.jsx("h4",{children:"All test failures"}),e.jsxs("div",{className:z,children:[e.jsx(g,{id:"standard-basic",label:"Name",variant:"standard",value:h,onChange:_}),e.jsx(g,{id:"standard-basic",label:"Date",variant:"standard",value:o,onChange:v})]}),e.jsx(x,{sx:{width:"100%",overflow:"hidden"},children:e.jsx(b,{component:x,children:e.jsxs(f,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[e.jsx(p,{children:e.jsxs(j,{children:[e.jsx(s,{className:l,children:"Test name"}),e.jsx(s,{className:l,children:"Job"}),e.jsx(s,{className:l,children:"Config"}),e.jsx(s,{className:l,children:"Status"}),e.jsx(s,{className:l,children:"Node"}),e.jsx(s,{className:l,sx:{minWidth:75},children:"Date"}),e.jsx(s,{className:l,children:"Build"}),e.jsx(s,{className:l,children:"Built On"}),e.jsx(s,{className:l,children:"Source"})]})}),e.jsx(N,{children:B.map((t,c)=>e.jsxs(j,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(s,{component:"th",scope:"row",children:t.testName}),e.jsx(s,{children:t.jobName}),e.jsx(s,{children:t.config}),e.jsx(s,{children:t.status}),e.jsx(s,{children:t.nodeVersion}),e.jsx(s,{children:t.date}),e.jsx(s,{children:e.jsx("a",{href:t.buildUrl,target:"_blank",rel:"noreferrer",children:t.buildNumber})}),e.jsx(s,{children:t.builtOn}),e.jsx(s,{children:e.jsx(E,{callStack:t.callStack})})]},c))})]})})})]})};export{A as Tests};
